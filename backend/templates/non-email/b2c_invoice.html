<!--------------------------------------------------------------------------------
-- File: backend/templates/non-email/b2c_invoice.html
-- Change: Implemented stylistic refinements for a more luxurious feel.
-------------------------------------------------------------------------------->
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facture</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Inter:wght@400;500&family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f9f5f0; /* brand-cream */
        }
        .font-serif {
            font-family: 'Playfair Display', serif;
        }
        .font-signature {
            font-family: 'Dancing Script', cursive;
        }
        /* Define brand colors from tailwind.config.js */
        .text-brand-dark-brown { color: #3a322f; }
        .bg-brand-cream { background-color: #f9f5f0; }
        .text-brand-burgundy { color: #800020; }
        .border-brand-burgundy { border-color: #800020; }
        .text-brand-dark-gray { color: #5a5a5a; }
        .border-brand-cream { border-color: #f9f5f0; }
    </style>
</head>
<body class="bg-brand-cream">
    <div class="max-w-3xl mx-auto my-16 p-16 bg-white shadow-sm">
        <!-- Header -->
        <header class="grid grid-cols-2 gap-4 items-start pb-8">
            <div>
                <h1 class="font-signature text-5xl font-bold text-brand-dark-brown">Maison Trüvra</h1>
                <p class="text-sm text-brand-dark-gray mt-1">123 Rue de la République, 75001 Paris, France</p>
            </div>
            <div class="text-right">
                <h2 class="font-serif text-2xl font-normal tracking-widest text-brand-dark-gray">FACTURE</h2>
                <p class="text-sm text-brand-dark-gray mt-2">Invoice <span class="text-brand-burgundy">#{{ invoice.invoice_number }}</span></p>
            </div>
        </header>

        <!-- Customer and Order Info -->
        <section class="grid grid-cols-2 gap-12 mt-10 pb-10 border-b border-gray-100">
            <div>
                <p class="text-sm font-semibold text-brand-dark-gray uppercase tracking-wider">Facturé à</p>
                <p class="font-semibold text-brand-dark-brown mt-2 text-lg">{{ customer_name }}</p>
                <p class="text-brand-dark-gray text-sm mt-1">{{ billing_address.street }}</p>
                <p class="text-brand-dark-gray text-sm">{{ billing_address.city }}, {{ billing_address.postal_code }}</p>
                <p class="text-brand-dark-gray text-sm">{{ billing_address.country }}</p>
            </div>
            <div class="text-right">
                <p class="text-sm font-semibold text-brand-dark-gray uppercase tracking-wider">Date de facturation</p>
                <p class="font-medium text-brand-dark-brown mt-2">{{ invoice.issue_date.strftime('%d %B %Y') }}</p>
                <p class="text-sm font-semibold text-brand-dark-gray uppercase tracking-wider mt-4">N° de commande</p>
                <p class="font-medium text-brand-dark-brown mt-2">{{ order.id }}</p>
            </div>
        </section>

        <!-- Items Table -->
        <section class="mt-10">
            <table class="w-full text-left">
                <thead class="border-b-2 border-brand-cream">
                    <tr>
                        <th class="py-4 px-3 text-sm font-semibold text-brand-dark-gray uppercase tracking-wider">Description</th>
                        <th class="py-4 px-3 text-sm font-semibold text-brand-dark-gray uppercase tracking-wider text-center">Qté</th>
                        <th class="py-4 px-3 text-sm font-semibold text-brand-dark-gray uppercase tracking-wider text-right">Prix Unitaire</th>
                        <th class="py-4 px-3 text-sm font-semibold text-brand-dark-gray uppercase tracking-wider text-right">Montant</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in order.items %}
                    <tr class="border-b border-gray-100">
                        <td class="py-4 px-3 text-brand-dark-brown">{{ item.product.name }}</td>
                        <td class="py-4 px-3 text-brand-dark-gray text-center">{{ item.quantity }}</td>
                        <td class="py-4 px-3 text-brand-dark-gray text-right">€{{ "%.2f"|format(item.price) }}</td>
                        <td class="py-4 px-3 text-brand-dark-gray text-right">€{{ "%.2f"|format(item.price * item.quantity) }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </section>

        <!-- Totals -->
        <section class="flex justify-end mt-10">
            <div class="w-full max-w-sm">
                <div class="flex justify-between py-2 text-brand-dark-gray">
                    <span>Sous-total</span>
                    <span>€{{ "%.2f"|format(order.subtotal) }}</span>
                </div>
                <div class="flex justify-between py-2 text-brand-dark-gray">
                    <span>Livraison</span>
                    <span>€{{ "%.2f"|format(order.shipping_cost) }}</span>
                </div>
                 <div class="flex justify-between py-2 text-brand-dark-gray">
                    <span>TVA</span>
                    <span>€{{ "%.2f"|format(order.taxes) }}</span>
                </div>
                <div class="flex justify-between py-4 mt-2 text-brand-dark-brown border-t-2 border-brand-cream">
                    <span class="font-serif font-bold text-xl">Total</span>
                    <span class="font-bold text-xl">€{{ "%.2f"|format(order.total_amount) }}</span>
                </div>
            </div>
        </section>
        
        <!-- Traceability Info -->
        <section class="mt-16 pt-8 border-t border-gray-100">
            <h3 class="font-serif text-lg text-brand-dark-brown mb-2">Fraîcheur et Traçabilité</h3>
            <p class="text-sm text-brand-dark-gray leading-relaxed">
                Chez Maison Trüvra, la fraîcheur, l'authenticité et la traçabilité de nos produits est primordiale. C'est dans cet esprit que chaque produit a son propre numéro d'identification. En prenant en photo le QR code imprimé sur l'étiquette de votre produit, vous serez redirigé vers une page web unique associée à votre produit. Vous trouverez sur cette page la date de récolte et de traitement associées à votre achat.        </section>

        <!-- Footer -->
        <footer class="mt-10 pt-6 border-t border-gray-100 text-center text-xs text-brand-dark-gray">
            <p>{{ company.legal_status }} Maison Trüvra - SIRET {{ company.siret }} - Capital social de {{ company.capital }}€ - Siège social {{ company.address }} - Numéro d'Identification à la TVA {{ company.vat_number }}</p>
            <p>Contactez-nous à <a href="mailto:{{ company.email }}" class="text-brand-burgundy hover:underline">{{ company.email }}</a> ou sur Instagram @maisontruvra</p>
        </footer>
    </div>
</body>
</html>
